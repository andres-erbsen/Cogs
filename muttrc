set mbox_type=Maildir
set folder=~/mail
set spoolfile=+inbox
set record=+sent;
set mbox=+archive

#set header_cache=~/mail/.mutt.hcache

set include=yes
set edit_headers=yes
set editor="vim +set\\ tw=72\\ spell\\ spelllang=en_us\\ wrap +/^$"

set sendmail="/usr/bin/msmtp"
set use_from=yes
set reverse_name
set my_user = "andres@krutt.org"
alternates andres.erbsen@krutt.org andreserbsen@gmail.com andres.erbsen@gmail.com andreser@mit.edu sookala@gmail.com theshad3@gmail.com tersorke@riseup.net andreserbsen@onenetbeyond.org pq@lavabit.com andres.erbsen@mit.edu
set envelope_from=yes

set sort=threads
set strict_threads="yes"
set sort_browser="reverse-date"
set sort_aux="last-date-received"
unset collapse_unread
bind index - collapse-thread
bind index _ collapse-all

source /etc/Muttrc.gpg.dist
set pgp_sign_as=0x9E403E27
set crypt_replyencrypt = yes
set crypt_replysign = yes
message-hook '!(~g|~G) ~b"^-----BEGIN\ PGP\ (SIGNED\ )?MESSAGE"' "exec check-traditional-pgp"
send-hook . 'reset pgp_autoencrypt'

source ~/.mutt-contacts

# mutt-kz notmuch configuration
set nm_default_uri="notmuch:///home/andres/mail/" # path to the maildir
set virtual_spoolfile=yes                         # enable virtual folders
virtual-mailboxes \
  "Andres"    "notmuch://?query=tag:inbox AND NOT tag:archive AND (to:andres OR to:andreser OR to:andres.erbsen OR to:r-h-c@mit.edu OR to:jiu-jitsu)"\
  "MIT"    "notmuch://?query=tag:inbox AND NOT tag:archive AND from:mit.edu)"\
  "Inbox"     "notmuch://?query=tag:inbox and NOT tag:archive"\
  "Unread"    "notmuch://?query=tag:unread"\
  "Starred"   "notmuch://?query=tag:*"\
  "Sent"      "notmuch://?query=tag:sent"\
  "All"       "notmuch://?query=date:.."

macro index \\ "<vfolder-from-query>"           # looks up a hand made query
macro index A "<modify-labels-then-hide>+archive -unread -inbox\n"        # tag as Archived
macro index S "<modify-labels-then-hide>-inbox -unread\n"                 # removed from inbox
macro index J "<modify-labels-then-hide>-inbox -unread +junk\n"           # tag as Junk mail
macro index Y "<modify-labels>+*\n<sync-mailbox>"                         # tag as starred
macro index N "<modify-labels>-*\n<sync-mailbox>"                         # tag as unstarred
